import base64
exec(base64.b64decode("IyEvYmluL3B5dGhvbjMNCiNjb2RlPV8tdWRmOjgtXw0KI2NyZWF0ZXIgOiANCg0KaW1wb3J0IG9zLHN5cw0KaW1wb3J0IHRpbWUNCiNmcm9tIGd0dHMgaW1wb3J0IGdUVFMNCmltcG9ydCBzdHJpbmcscmFuZG9tIA0KDQojTWFpbl9NZW51Oi0NCmRlZiBNYWluKCk6DQogICAgb3Muc3lzdGVtKCdjbGVhcicpDQogICAgcHJpbnQoJ1vigKJdIFRoaXMgU2NyaXB0IE1ha2VkIEJ5IEJFU1QgVEVDSE5JQ0FMXG5b4oCiXSBURUFNIMKpIDogQkVTVCBURUNITklDQUxcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKQ0KICAgIHByaW50KCdbMV0gRHVtcCBSYW5kb20gTmV3IFVJRCAoMTAwMDgpJykNCiAgICBwcmludCgnWzJdIER1bXAgUmFuZG9tIE9sZCBVSUQgKDEwMDAwMCknKQ0KICAgIHByaW50KCdbMF0gRXhpdCBNZW51ICcpDQogICAgTWU9aW5wdXQoJ1vigKJdIENob29zZSA6ICcpDQogICAgaWYgTWUgPT0nMSc6DQogICAgICAgIHJhbmRvbV9uZXdfZHVtcCgpDQogICAgZWxpZiBNZSA9PScyJzoNCiAgICAgICAgcmFuZG9tX29sZF9kdW1wKCkNCiAgICBlbGlmIE1lID09JzAnOg0KICAgICAgICBleGl0KCdb4oCiXSBUaG54IEZvciBVc2UgJykNCiAgICBlbHNlOg0KICAgICAgICBwcmludCgnW8OXXSBDaG9vc2UgQ29ycmVjdCBPcHRpb24gOiAnKTt0aW1lLnNsZWVwKDEpDQogICAgICAgIE1haW4oKSANCiMgQ3JlYXRlIERlZiBmYiBuZXcgYXV0b19yYW5kb20gdWlkIGR1bXAgLS0NCmRlZiByYW5kb21fbmV3X2R1bXAoKToNCiAgICBwcmludCgnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpDQogICAgdHJ5Og0KICAgICAgICB1c2VyID0gW10NCiAgICAgICAgcHJpbnQoIlsqXSBFbnRlciBGaXJzdCA2IGRpZ2l0IG9mIGFueSBVSUQiKQ0KICAgICAgICBwcmludCgiWypdIDEwMDAwMCAgIDEwMDAxMCAgMTAwMDIwIikNCiAgICAgICAgcHJpbnQoIlsqXSAxMDAwODMgICAxMDAwODQgIDEwMDA4NSIpDQogICAgICAgIHVzZXJfaWQgPSBpbnB1dCgiWypdIEVudGVyIERpZ2l0IFVzZXIgSUQgOiAiKQ0KICAgICAgICBzYXZlX2ZpbGUgPSBpbnB1dCgiWypdIER1bXAgRmlsZSBTYXZlIEFzIDogIikNCiAgICAgICAgaWYgbGVuKHVzZXJfaWQpPT02Og0KICAgICAgICAgICAgY29kZSA9IHVzZXJfaWQNCiAgICAgICAgZWxpZiBsZW4odXNlcl9pZCk+NjoNCiAgICAgICAgICAgIGNvZGUgPSB1c2VyX2lkWzo2XQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgcHJpbnQoIldyb25nIFVzZXIgSW5wdXQiKQ0KICAgICAgICAgICAgZXhpdCgpDQogICAgICAgIGxpbWl0ID0gaW50KGlucHV0KCJbKl0gRW50ZXIgRHVtcCBMaW1pdCA6ICIpKQ0KICAgICAgICBpZiAobGltaXQpPjUwMDA6DQogICAgICAgICAgICBsaW1pdCA9IDUwMDANCiAgICAgICAgZm9yIG51bWJlciBpbiByYW5nZShsaW1pdCk6DQogICAgICAgICAgICBubXAgPSAnJy5qb2luKHJhbmRvbS5jaG9pY2Uoc3RyaW5nLmRpZ2l0cykgZm9yIF8gaW4gcmFuZ2UoOSkpDQogICAgICAgICAgICB1c2VyLmFwcGVuZChubXApDQogICAgICAgIGR1bXBwID0gb3BlbihzYXZlX2ZpbGUsJ3cnKQ0KICAgICAgICBmb3IgYmlsYWwgaW4gdXNlcjoNCiAgICAgICAgICAgIHVpZCA9IGNvZGUrYmlsYWwNCiAgICAgICAgICAgIGR1bXBwLndyaXRlKHVpZCsnIHwgJysnQi1UX1JBTkRPTV9EVU1QJysnXG4nKQ0KICAgICAgICAgICAgcHJpbnQodWlkKycgfCAnKydCLVRfUkFORE9NX0RVTVAnKQ0KICAgICAgICAgICAgdGltZS5zbGVlcCgwLjA1KQ0KICAgICAgICBkdW1wcC5jbG9zZSgpDQogICAgICAgIHByaW50KCJEdW1waW5nIERvbmUgIikNCiAgICAgICAgcHJpbnQoZiJZb3VyIEZpbGUgU2F2ZSBBcyB7c2F2ZV9maWxlfSIpDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICBwcmludChlKQ0KDQpkZWYgcmFuZG9tX29sZF9kdW1wKCk6DQogICAgcHJpbnQoJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKQ0KICAgIHRyeToNCiAgICAgICAgdXNlciA9IFtdDQogICAgICAgIHByaW50KCJbKl0gRW50ZXIgRmlyc3QgNiBkaWdpdCBvZiBhbnkgVUlEIikNCiAgICAgICAgcHJpbnQoIlsqXSAxMDAwMDAwICAgMTAwMDAwMDAgIDEwMDAwMDAwMCIpDQogICAgICAgIHVzZXJfaWQgPSBpbnB1dCgiWypdIEVudGVyIERpZ2l0IFVzZXIgSUQgOiAiKQ0KICAgICAgICBzYXZlX2ZpbGUgPSBpbnB1dCgiWypdIER1bXAgRmlsZSBTYXZlIEFzIDogIikNCiAgICAgICAgaWYgbGVuKHVzZXJfaWQpPT02Og0KICAgICAgICAgICAgZGlnaXR0ID0gOQ0KICAgICAgICBlbGlmIGxlbih1c2VyX2lkKT09NzoNCiAgICAgICAgICAgIGRpZ2l0dCA9IDgNCiAgICAgICAgZWxpZiBsZW4odXNlcl9pZCk9PTg6DQogICAgICAgICAgICBkaWdpdHQgPSA3DQogICAgICAgIGVsaWYgbGVuKHVzZXJfaWQpPT05Og0KICAgICAgICAgICAgZGlnaXQgPSA2DQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBwcmludCgiV3JvbmcgVXNlciBJbnB1dCIpDQogICAgICAgICAgICBleGl0KCkNCiAgICAgICAgY29kZSA9IHVzZXJfaWQNCiAgICAgICAgbGltaXQgPSBpbnQoaW5wdXQoIlsqXSBFbnRlciBEdW1wIExpbWl0IDogIikpDQogICAgICAgIGlmIChsaW1pdCk+NTAwMDoNCiAgICAgICAgICAgIGxpbWl0ID0gNTAwMA0KICAgICAgICBmb3IgbnVtYmVyIGluIHJhbmdlKGxpbWl0KToNCiAgICAgICAgICAgIG5tcCA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZShzdHJpbmcuZGlnaXRzKSBmb3IgXyBpbiByYW5nZShkaWdpdHQpKQ0KICAgICAgICAgICAgdXNlci5hcHBlbmQobm1wKQ0KICAgICAgICBkdW1wcCA9IG9wZW4oc2F2ZV9maWxlLCd3JykNCiAgICAgICAgZm9yIGJpbGFsIGluIHVzZXI6DQogICAgICAgICAgICB1aWQgPSBjb2RlK2JpbGFsDQogICAgICAgICAgICBkdW1wcC53cml0ZSh1aWQrJyB8ICcrJ0ItVF9SQU5ET01fRFVNUCcrJ1xuJykNCiAgICAgICAgICAgIHByaW50KHVpZCsnIHwgJysnQi1UX1JBTkRPTV9EVU1QJykNCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMC4wNSkNCiAgICAgICAgZHVtcHAuY2xvc2UoKQ0KICAgICAgICBwcmludCgiRHVtcGluZyBEb25lICIpDQogICAgICAgIHByaW50KGYiWW91ciBGaWxlIFNhdmUgQXMge3NhdmVfZmlsZX0iKQ0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgcHJpbnQoZSkNCk1haW4oKQ=="))